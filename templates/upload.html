if (result.summary && Array.isArray(result.summary)) {
          const tableContainer = document.createElement('div');
          tableContainer.className = 'table-container glass-card';
          tableContainer.style.position = 'relative';
          
          const table = document.createElement('table');
          table.classList.add('summary-table');

          const headers = ['Category', 'Score', 'Questions'];
          const thead = document.createElement('thead');
          const headRow = document.createElement('tr');
          headers.forEach(h => {
            const th = document.createElement('th');
            th.textContent = h;
            headRow.appendChild(th);
          });
          thead.appendChild(headRow);
          table.appendChild(thead);

          const tbody = document.createElement('tbody');
          result.summary.forEach(row => {
            const tr = document.createElement('tr');
            // Use normalized keys: name, score, questions
            const cells = [row.name || '', row.score || '', row.questions || ''];
            cells.forEach(cell => {
              const td = document.createElement('td');
              td.textContent = cell;
              tr.appendChild(td);
            });
            tbody.appendChild(tr);
          });
          table.appendChild(tbody);
          tableContainer.appendChild(table);
          summaryTable.innerHTML = '';
          summaryTable.appendChild(tableContainer);
        } else {
          summaryTable.innerHTML = '';
        }
